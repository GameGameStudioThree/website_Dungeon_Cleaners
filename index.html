<!DOCTYPE html>
<html lang="en">
<head>
    <title>Dungeon Cleaners - I just recycle my friend for money</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    
    <!-- HTML Meta Tags -->
    <meta name="description" content="Dungeon Cleaners : They came. They're dead. It's up to you to clean up." />
    <meta name="keywords" content="Dungeon Cleaners, game, multiplayer dungeon crawler, co-op, 1-4 player co-op, dungeon janitors, friend slop, indie action game, PC action game" />
    <meta name="author" content="Baguette Games" />
    <meta name="robots" content="index, follow" />
    
    <!-- Open Graph / Facebook Meta Tags -->
    <meta property="og:url" content="https://dungeoncleaners.org" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Dungeon Cleaners" />
    <meta property="og:description" content="Dungeon Cleaners : They came. They're dead. It's up to you to clean up." />
    <meta property="og:image" content="https://dungeoncleaners.org/image/logo_transp.png" />
    <meta property="og:image:type" content="image/webp">
    <meta property="og:image:width" content="1000">
    <meta property="og:image:height" content="1000">
    <meta property="og:image:alt" content="This is the Dungeon Cleaners logo" />

    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@DungeonCleaners" />
    <meta name="twitter:creator" content="@DungeonCleaners" />
    <meta name="twitter:url" content="https://dungeoncleaners.org" />
    <meta name="twitter:title" content="Dungeon Cleaners" />
    <meta name="twitter:description" content="Dungeon Cleaners : They came. They're dead. It's up to you to clean up." />
    <meta name="twitter:image" content="https://dungeoncleaners.org/image/logo_transp.png" />
    
    <!-- Canonical Tag for SEO -->
    <link rel="canonical" href="https://dungeoncleaners.org" />
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ§¹</text></svg>">
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            cursor: default;
        }
        h1, h2, h3, .pixel-font {
            font-family: 'Press Start 2P', cursive;
        }
        /* Custom Cursor for the game area */
        .mop-cursor {
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewport="0 0 48 48" style="fill:black;font-size:36px"><text y="50%">ðŸ§¹</text></svg>') 24 24, auto; 
        }
        
        #dirt-canvas {
            touch-action: none;
        }
        
        /* Prevent overscroll on iOS - only when overlay is active */
        body.intro-active {
            overscroll-behavior: none;
            position: fixed;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        
        #intro-overlay {
            overscroll-behavior: none;
        }

        .neon-text {
            text-shadow: 0 0 5px #fff, 0 0 10px #ffd700, 0 0 20px #ffd700, 0 0 30px #ff0000, 0 0 40px #ff0000;
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
            100% { transform: translateY(0px); }
        }
        .float-anim {
            animation: float 4s ease-in-out infinite;
        }
        
        @keyframes logo-pulse {
            0% { transform: scale(1); filter: drop-shadow(0 0 15px rgba(255, 255, 255, 0.4)); }
            50% { transform: scale(1.03); filter: drop-shadow(0 0 40px rgba(255, 255, 255, 1)); }
            100% { transform: scale(1); filter: drop-shadow(0 0 15px rgba(255, 255, 255, 0.4)); }
        }
        .logo-anim {
            animation: logo-pulse 3s ease-in-out infinite;
        }
        @keyframes spin-slow {
            from { transform: rotate(0deg) scale(1.25); }
            to { transform: rotate(360deg) scale(1.25); }
        }
        .radial-spin {
            animation: spin-slow 10s linear infinite;
        }
    </style>
</head>
<body class="bg-[#1a0505] text-white overflow-x-hidden">

    <!-- Intro / Mini Game Overlay -->
    <div id="intro-overlay" class="fixed inset-0 z-50 flex items-center justify-center bg-[url('image/image1.webp')] bg-cover bg-center mop-cursor">
        <canvas id="dirt-canvas" class="absolute inset-0 w-full h-full"></canvas>
        <div id="intro-text" class="absolute pointer-events-none text-center select-none z-10 transition-opacity duration-500">
            <h2 class="text-4xl md:text-6xl text-yellow-500 mb-4 pixel-font neon-text">IT'S A MESS!</h2>
            <p class="text-xl md:text-2xl text-gray-300 animate-pulse">Use your mop to clean the screen...</p>
        </div>
        <div id="progress-container" class="absolute bottom-10 left-1/2 transform -translate-x-1/2 w-64 h-4 bg-gray-900 rounded-full border-2 border-yellow-600 pointer-events-none z-10">
            <div id="clean-progress" class="h-full bg-yellow-500 rounded-full transition-all duration-100" style="width: 0%"></div>
        </div>
        <button id="skip-btn" class="absolute bottom-4 right-4 text-gray-500 hover:text-white text-xl z-20 underline cursor-pointer">Skip Intro</button>
    </div>

    <!-- Navigation -->
    <nav class="fixed w-full z-40 bg-[#1a0505]/90 border-b border-red-900 backdrop-blur-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <span class="text-yellow-500 text-xl pixel-font">DJ</span>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#home" class="hover:bg-red-900 text-white px-3 py-2 rounded-md text-sm font-medium">Home</a>
                        <a href="#features" class="hover:bg-red-900 text-gray-300 px-3 py-2 rounded-md text-sm font-medium">Features</a>
                        <a href="#media" class="hover:bg-red-900 text-gray-300 px-3 py-2 rounded-md text-sm font-medium">Media</a>
                        <a href="http://site1.com" class="bg-red-800 hover:bg-red-700 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors border border-yellow-600 inline-block">Pre-Order Now</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="relative h-screen flex items-center justify-center bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyMCIgaGVpZ2h0PSIxMDgwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxkZWZzPjxsaW5lYXJHcmFkaWVudCBpZD0iZHVuZ2VvbiIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiMxYTFhMWE7c3RvcC1vcGFjaXR5OjEiIC8+PHN0b3Agb2Zmc2V0PSIxMDAlIiBzdHlsZT0ic3RvcC1jb2xvcjojMGYxNzJhO3N0b3Atb3BhY2l0eToxIiAvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHdpZHRoPSIxOTIwIiBoZWlnaHQ9IjEwODAiIGZpbGw9InVybCgjZHVuZ2VvbikiLz48Y2lyY2xlIGN4PSI0MDAiIGN5PSIzMDAiIHI9IjUiIGZpbGw9IiM2NjY2NjYiIG9wYWNpdHk9IjAuMyIvPjxjaXJjbGUgY3g9IjgwMCIgY3k9IjIwMCIgcj0iMyIgZmlsbD0iIzY2NjY2NiIgb3BhY2l0eT0iMC4zIi8+PGNpcmNsZSBjeD0iMTIwMCIgY3k9IjQwMCIgcj0iNCIgZmlsbD0iIzY2NjY2NiIgb3BhY2l0eT0iMC4zIi8+PGNpcmNsZSBjeD0iMTYwMCIgY3k9IjMwMCIgcj0iMyIgZmlsbD0iIzY2NjY2NiIgb3BhY2l0eT0iMC4zIi8+PGNpcmNsZSBjeD0iMzAwIiBjeT0iNzAwIiByPSI0IiBmaWxsPSIjNjY2NjY2IiBvcGFjaXR5PSIwLjMiLz48Y2lyY2xlIGN4PSIxNDAwIiBjeT0iODAwIiByPSI1IiBmaWxsPSIjNjY2NjY2IiBvcGFjaXR5PSIwLjMiLz48L3N2Zz4=')] bg-cover bg-center">
        <div class="absolute inset-0 bg-[url('image/radial.gif')] bg-cover bg-center opacity-60 mix-blend-overlay"></div>
        <div class="absolute inset-0 bg-[radial-gradient(circle,rgba(50,10,10,0.4)_0%,rgba(15,2,2,0.95)_80%)]"></div>
        <div class="relative z-10 text-center px-4 max-w-4xl mx-auto">
            <div class="mb-8 inline-block">
                <span class="bg-yellow-600 text-black text-xs px-2 py-1 rounded font-bold uppercase tracking-wide">Coming 2025</span>
            </div>
            
            <!-- Fixed Logo -->
            <div class="relative w-full max-w-xl mx-auto mb-8">
                <img src="image/radial.png" alt="" class="absolute inset-0 w-full h-full object-contain opacity-50 mix-blend-screen radial-spin">
                <img src="image/logo.webp" alt="Dungeon Janitor Logo" class="relative z-10 w-full logo-anim">
            </div>

            <p class="text-xl text-gray-300 mb-10 max-w-2xl mx-auto">
                Heroes slay the monsters. You clean up the mess. Experience the first-ever visceral first-person janitorial simulator set in a fantasy dungeon.
            </p>
            <div class="flex flex-col sm:flex-row justify-center gap-4">
                <a href="http://site2.com" class="inline-block px-8 py-4 bg-red-800 hover:bg-red-700 text-white font-bold rounded shadow-[0_0_15px_rgba(255,215,0,0.3)] transition-all transform hover:scale-105 pixel-font text-sm border border-yellow-600 no-underline">
                    PLAY TRAILER
                </a>
                <a href="https://store.steampowered.com/app/3756600/Dungeon_Cleaners/" target="_blank" rel="noopener noreferrer" class="inline-block px-8 py-4 bg-transparent border-2 border-white hover:bg-white hover:text-black text-white font-bold rounded transition-all transform hover:scale-105 pixel-font text-sm no-underline">
                    WISHLIST ON STEAM
                </a>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section id="features" class="py-20 bg-[#2a0a0a]">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-4xl font-bold text-white mb-4 pixel-font text-yellow-500">GAME FEATURES</h2>
                <div class="w-24 h-1 bg-yellow-600 mx-auto"></div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- Feature 1 -->
                <div class="bg-[#3d1010] p-8 rounded-lg border border-red-900 hover:border-yellow-500 transition-colors float-anim" style="animation-delay: 0s;">
                    <div class="text-4xl mb-4">ðŸ§¹</div>
                    <h3 class="text-xl font-bold text-white mb-2">Advanced Mop Physics</h3>
                    <p class="text-gray-400">
                        Feel the weight of the grime. Our proprietary SlimeEngineâ„¢ calculates viscosity in real-time.
                    </p>
                </div>
                
                <!-- Feature 2 -->
                <div class="bg-[#3d1010] p-8 rounded-lg border border-red-900 hover:border-yellow-500 transition-colors float-anim" style="animation-delay: 1s;">
                    <div class="text-4xl mb-4">ðŸ§ª</div>
                    <h3 class="text-xl font-bold text-white mb-2">Alchemy Cleaning</h3>
                    <p class="text-gray-400">
                        Mix potions to dissolve dragon blood, goblin guts, and mystery oozes. Don't mix the wrong ones!
                    </p>
                </div>
                
                <!-- Feature 3 -->
                <div class="bg-[#3d1010] p-8 rounded-lg border border-red-900 hover:border-yellow-500 transition-colors float-anim" style="animation-delay: 2s;">
                    <div class="text-4xl mb-4">ðŸ’°</div>
                    <h3 class="text-xl font-bold text-white mb-2">Loot the Leftovers</h3>
                    <p class="text-gray-400">
                        Keep what the heroes missed. Upgrade your mop, bucket, and boots with legendary loot.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Media Section -->
    <section id="media" class="py-20 bg-[#1a0505]">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col md:flex-row items-center gap-12">
                <div class="w-full md:w-1/2">
                    <img id="gameplay-carousel" src="image/image1.webp" alt="Gameplay Screenshot" class="rounded-lg shadow-2xl border-2 border-yellow-600 transform -rotate-2 hover:rotate-0 transition-transform duration-500 object-cover w-full h-64 md:h-96">
                </div>
                <div class="w-full md:w-1/2">
                    <h2 class="text-3xl font-bold text-white mb-6 pixel-font">BEFORE THE NEXT RAID</h2>
                    <p class="text-gray-300 text-lg mb-6">
                        The dungeon doesn't clean itself. You are the unsung hero of the underworld. While adventurers get the glory, you get the minimum wage gold coins.
                    </p>
                    <ul class="space-y-4 text-gray-300">
                        <li class="flex items-center">
                            <span class="text-yellow-500 mr-2">âœ“</span> Co-op cleaning mode (up to 4 janitors)
                        </li>
                        <li class="flex items-center">
                            <span class="text-yellow-500 mr-2">âœ“</span> Over 50 types of mythical stains
                        </li>
                        <li class="flex items-center">
                            <span class="text-yellow-500 mr-2">âœ“</span> Career mode: From Tavern to Throne Room
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- Newsletter -->
    <section class="py-20 bg-red-950 relative overflow-hidden border-t border-red-900">
        <div class="absolute inset-0 opacity-10 bg-[url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDQwIDQwIj48ZyBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0wIDQwTDQwIDBIMHY0MHpNNDAgNDBWMHgyMHYyMHoiIGZpbGw9IiNmZmYiIG9wYWNpdHk9IjEiLz48L2c+PC9zdmc+')]"></div>
        <div class="max-w-4xl mx-auto px-4 text-center relative z-10">
            <h2 class="text-3xl font-bold text-white mb-4 pixel-font">JOIN THE CLEAN-UP CREW</h2>
            <p class="text-red-200 mb-8">Sign up for updates and get an exclusive "Golden Mop" skin at launch.</p>
            <form class="flex flex-col sm:flex-row gap-4 justify-center">
                <input type="email" placeholder="Enter your email" class="px-6 py-3 rounded bg-red-900 text-white border border-yellow-600 focus:outline-none focus:border-white w-full sm:w-auto placeholder-red-300">
                <button type="submit" class="px-8 py-3 bg-yellow-600 text-black font-bold rounded hover:bg-yellow-500 transition-colors pixel-font text-xs">
                    SUBSCRIBE
                </button>
            </form>
        </div>
    </section>

    <footer class="bg-black py-8 text-center text-gray-600 text-sm border-t border-red-900">
        <div class="flex justify-center gap-6 mb-6">
            <!-- Instagram -->
            <a href="https://instagram.com" target="_blank" rel="noopener noreferrer" class="text-gray-500 hover:text-yellow-500 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.917 3.917 0 0 0-1.417.923A3.927 3.927 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.916 3.916 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.926 3.926 0 0 0-.923-1.417A3.911 3.911 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0h.003zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599.28.28.453.546.598.92.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.47 2.47 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.232-.047c-.78-.036-1.203-.166-1.485-.276a2.478 2.478 0 0 1-.92-.598 2.48 2.48 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233 0-2.136.008-2.388.046-3.231.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92.28-.28.546-.453.92-.598.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045v.002zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92zm-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217zm0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334z"/>
                </svg>
            </a>
            <!-- Steam -->
            <a href="https://store.steampowered.com" target="_blank" rel="noopener noreferrer" class="text-gray-500 hover:text-yellow-500 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M.329 10.333A8.01 8.01 0 0 0 7.99 16C12.414 16 16 12.418 16 8s-3.586-8-8.009-8A8.006 8.006 0 0 0 0 7.468l.003.006 4.304 1.769A2.198 2.198 0 0 1 5.62 8.88l1.96-2.844-.001-.04a3.046 3.046 0 0 1 3.042-3.043 3.046 3.046 0 0 1 3.042 3.043 3.047 3.047 0 0 1-3.111 3.044l-2.804 2a2.223 2.223 0 0 1-3.075 2.11 2.217 2.217 0 0 1-1.312-1.568L.33 10.333Z"/>
                    <path d="M4.868 12.683a1.715 1.715 0 0 0 1.318-3.165 1.705 1.705 0 0 0-1.263.02l.476.425c.15.135.282.28.393.434.369-.268.532-.75.419-1.217-.192-.79-1.059-1.258-1.825-.955l-.596-.532A2.32 2.32 0 0 1 5.6 6.99c1.287 0 2.33 1.043 2.33 2.33s-1.043 2.33-2.33 2.33c-1.287 0-2.33-1.043-2.33-2.33 0-.38.093-.737.258-1.053l.84.753c-.048.097-.074.206-.074.319 0 .605.62 1.032 1.154.84l-.61-.546a.66.66 0 0 1-.27.03.66.66 0 0 1-.61-.9.659.659 0 0 1 1.077.206l-.16.142c-.211.187-.446.352-.698.491a1.71 1.71 0 0 0 .69.083z"/>
                </svg>
            </a>
            <!-- TikTok -->
            <a href="https://tiktok.com" target="_blank" rel="noopener noreferrer" class="text-gray-500 hover:text-yellow-500 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M9 0h1.98c.144.715.54 1.617 1.235 2.512C12.895 3.389 13.797 4 15 4v2c-1.753 0-3.07-.814-4-1.829V11a5 5 0 1 1-5-5v2a3 3 0 1 0 3 3V0Z"/>
                </svg>
            </a>
            <!-- Twitch -->
            <a href="https://twitch.com" target="_blank" rel="noopener noreferrer" class="text-gray-500 hover:text-yellow-500 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M3.857 0 1 2.857v10.286h3.429V16l2.857-2.857H9.57L14.714 8V0H3.857zm9.714 7.429-2.285 2.285H9l-2 2v-2H4.429V1.143h9.142v6.286z"/>
                    <path d="M11.857 3.143h-1.143V6.57h1.143V3.143zm-3.143 0H7.571V6.57h1.143V3.143z"/>
                </svg>
            </a>
        </div>
        <p>&copy; 2025 Dungeon Janitor Studios. All rights dirty.</p>
    </footer>

    <!-- Audio Player Controls -->
    <div id="audio-controls" class="fixed bottom-4 left-4 z-50 hidden flex flex-col items-center">
        <span id="play-hint" class="text-yellow-500 text-xs pixel-font mb-2 animate-bounce shadow-black drop-shadow-md select-none pointer-events-none">PLAY ME</span>
        <button id="music-toggle" class="bg-red-900/80 hover:bg-red-800 text-yellow-500 border border-yellow-600 p-3 rounded-full shadow-lg transition-all hover:scale-110 cursor-pointer">
            <span id="music-icon">ðŸ”‡</span>
        </button>
        <audio id="bg-music" loop>
            <source src="music/audio.mp3" type="audio/mpeg">
        </audio>
    </div>

    <script src="config.js"></script>
    <script>
        // --- Mini Game Logic ---
        document.addEventListener('DOMContentLoaded', () => {
            // Add class to body to prevent scrolling during intro
            document.body.classList.add('intro-active');
            const canvas = document.getElementById('dirt-canvas');
            const ctx = canvas.getContext('2d');
            const introOverlay = document.getElementById('intro-overlay');
            const introText = document.getElementById('intro-text');
            const progressBar = document.getElementById('clean-progress');
            
            let width, height;
            let isDrawing = false;
            
            // Resize canvas to fill screen
            function resize() {
                width = window.innerWidth;
                height = window.innerHeight;
                canvas.width = width;
                canvas.height = height;
                
                // Redraw dirt on resize
                fillDirt();
            }

            function fillDirt() {
                ctx.globalCompositeOperation = 'source-over';
                ctx.fillStyle = CONFIG.colors.dirtBase;
                ctx.fillRect(0, 0, width, height);
                
                // Add some "slime" spots using config values
                for(let i=0; i<CONFIG.miniGame.slimeSpots; i++) {
                    const x = Math.random() * width;
                    const y = Math.random() * height;
                    const r = Math.random() * (CONFIG.miniGame.slimeMaxSize - CONFIG.miniGame.slimeMinSize) + CONFIG.miniGame.slimeMinSize;
                    
                    ctx.beginPath();
                    ctx.arc(x, y, r, 0, Math.PI * 2);
                    ctx.fillStyle = Math.random() > 0.5 ? CONFIG.colors.slimeVariant1 : CONFIG.colors.slimeVariant2;
                    ctx.fill();
                }

                progressBar.style.width = '0%';
            }
            
            function getMousePos(evt) {
                const rect = canvas.getBoundingClientRect();
                // Handle touch and mouse
                const clientX = evt.touches ? evt.touches[0].clientX : evt.clientX;
                const clientY = evt.touches ? evt.touches[0].clientY : evt.clientY;
                return {
                    x: clientX - rect.left,
                    y: clientY - rect.top
                };
            }
            
            function scratch(x, y) {
                ctx.globalCompositeOperation = 'destination-out';
                ctx.beginPath();
                ctx.arc(x, y, CONFIG.miniGame.mopSize, 0, Math.PI * 2);
                ctx.fill();
            }
            
            let checkInterval = null;
            
            function checkProgress() {
                const sampleStep = CONFIG.miniGame.sampleStep;
                // Get context safely (sometimes issue on detach)
                if(!ctx) return;

                // Optimization: only sample a portion or handle errors
                try {
                    const imageData = ctx.getImageData(0, 0, width, height);
                    const data = imageData.data;
                    let transparentCount = 0;
                    let sampleCount = 0;
                    
                    for (let i = 3; i < data.length; i += 4 * sampleStep) {
                        sampleCount++;
                        if (data[i] === 0) { // Alpha channel is 0
                            transparentCount++;
                        }
                    }
                    
                    const percentage = Math.floor((transparentCount / sampleCount) * 100);
                    progressBar.style.width = percentage + '%';
                    
                    if (percentage > CONFIG.miniGame.cleanThreshold) {
                        finishGame();
                    }
                } catch(e) {
                    console.error("Canvas read error", e);
                }
            }

            function finishGame() {
                // Remove body class to allow scrolling
                document.body.classList.remove('intro-active');
                
                // First fade out the dirt and UI elements to reveal the clean floor fully
                canvas.style.transition = 'opacity 0.5s';
                canvas.style.opacity = '0';
                introText.style.opacity = '0';
                document.getElementById('progress-container').style.opacity = '0';
                
                // Then after a short delay, fade out the floor to reveal the site
                setTimeout(() => {
                    introOverlay.style.transition = 'opacity 1s';
                    introOverlay.style.opacity = '0';
                }, 800);

                setTimeout(() => {
                    introOverlay.style.display = 'none';
                    // Start Music Here
                    startMusic();
                }, 1800);
                
                if (checkInterval) clearInterval(checkInterval);
            }

            // Event Listeners
            window.addEventListener('resize', resize);
            
            // Mouse
            canvas.addEventListener('mousedown', (e) => {
                isDrawing = true;
                scratch(getMousePos(e).x, getMousePos(e).y);
                if (!checkInterval) checkInterval = setInterval(checkProgress, CONFIG.miniGame.progressCheckInterval);
            });
            window.addEventListener('mouseup', () => {
                isDrawing = false;
                if (checkInterval) {
                    clearInterval(checkInterval);
                    checkInterval = null;
                    checkProgress(); // One last check
                }
            });
            canvas.addEventListener('mousemove', (e) => {
                if (!isDrawing) return;
                const pos = getMousePos(e);
                scratch(pos.x, pos.y);
            });

            // Touch
            canvas.addEventListener('touchstart', (e) => {
                e.preventDefault(); // Prevent scrolling
                isDrawing = true;
                const pos = getMousePos(e);
                scratch(pos.x, pos.y);
                if (!checkInterval) checkInterval = setInterval(checkProgress, CONFIG.miniGame.progressCheckInterval);
            }, { passive: false });
            canvas.addEventListener('touchend', () => {
                isDrawing = false;
                if (checkInterval) {
                    clearInterval(checkInterval);
                    checkInterval = null;
                }
            });
            canvas.addEventListener('touchmove', (e) => {
                e.preventDefault(); 
                if (!isDrawing) return;
                const pos = getMousePos(e);
                scratch(pos.x, pos.y);
            }, { passive: false });

            // Init
            resize();

            // Skip Button
            document.getElementById('skip-btn').addEventListener('click', finishGame);

            // --- Image Carousel Logic ---
            const carouselImg = document.getElementById('gameplay-carousel');
            const images = ['image/image1.webp', 'image/image2.webp', 'image/image3.webp', 'image/image4.webp', 'image/image5.webp', 'image/image6.webp'];
            let currentImgIndex = 0;

            setInterval(() => {
                currentImgIndex = (currentImgIndex + 1) % images.length;
                carouselImg.style.opacity = '0'; // Fade out
                setTimeout(() => {
                    carouselImg.src = images[currentImgIndex];
                    carouselImg.onload = () => {
                        carouselImg.style.opacity = '1'; // Fade in
                    };
                }, 500); // Wait for fade out
            }, 10000); // 10 seconds

            // --- Audio Player Logic ---
            const musicToggle = document.getElementById('music-toggle');
            const bgMusic = document.getElementById('bg-music');
            const musicIcon = document.getElementById('music-icon');
            const audioControls = document.getElementById('audio-controls');
            const playHint = document.getElementById('play-hint');

            function startMusic() {
                audioControls.classList.remove('hidden');
                // Start paused (muted)
                bgMusic.pause();
                bgMusic.currentTime = 0;
                bgMusic.volume = 0.3;
                musicIcon.textContent = 'ðŸ”‡';
            }

            musicToggle.addEventListener('click', () => {
                if (bgMusic.paused) {
                    bgMusic.play().then(() => {
                         musicIcon.textContent = 'ðŸ”Š';
                         if(playHint) playHint.style.display = 'none';
                    }).catch(e => console.error("Audio play error:", e));
                } else {
                    bgMusic.pause();
                    musicIcon.textContent = 'ðŸ”‡';
                }
            });

            // Hook into finishGame to start music
            const originalFinishGame = finishGame; // Capture the local function reference if possible, 
            // but since finishGame is defined inside the closure above, we need to move this logic inside the closure 
            // or modify the finishGame function directly.
            // Since I am appending this script, I cannot easily access 'finishGame' from outside if it wasn't exposed.
            // However, I am editing the script block *inside* the DOMContentLoaded event in the previous steps? 
            // Wait, the previous 'replacement' was just the end of the block.
            // Correct approach: I need to modify the `finishGame` function inside the main logic block.
            
            // Let's re-edit the `finishGame` function in the main block instead of appending code that might not reach the scope.
        });
    </script>
</body>
</html>